

```python
from pyspark.sql import Row
from pyspark.sql.types import *
import pyspark.sql.functions as f
from pyspark.sql.functions import lit
import pandas as pd
import numpy as np
sqlContext = SQLContext(sc)
lines=sc.textFile("/data/Traffic_1000BS_Final")
# lines.take(100)
#device ID|start time|end time|location(base station ID)|traffic volumns(Bytes)|
```


```python
# lines.take(100)
```


```python
#--filter by location in RDD
# location_01077=lines.filter(lambda x:'00442' in x.split('\t')[3])
# location01077=location_01077.map(lambda x:(x.split('\t')[3],x.split('\t')[0],int(x.split('\t')[1]),int(x.split('\t')[1])/3600,
#                                  int(x.split('\t')[4])))
location01077=lines.map(lambda x:(int(x.split('\t')[1])/3600,
   x.split('\t')[3],x.split('\t')[0],int(x.split('\t')[1])
                                # int(x.split('\t')[4])
                                          ))
```


```python
# location01077.take(10)
```


```python
# location01077=sc.parallelize([(114, '00001', '000001', 410565),
#  (114, '00442', '000003', 410565),
#  (669, '00406', '000059', 2410565),
#  (669, '00844', '000149', 2410565),
#  (391, '00163', '003574', 1410565),
#  (669, '00164', '003620', 2410565),
#  (391, '00110', '005914', 1410565),
#  (391, '01086', '017230', 1410565),
#  (114, '00622', '018268', 410565),
#                                (114, '00442', '000013', 410565),
#  (669, '00406', '000159', 2410565),
#  (669, '00844', '001149', 2410565),
#  (391, '00163', '013574', 1410565),
#  (669, '00164', '013620', 2410565),
#  (391, '00110', '215914', 1410565),
#                                (391, '00110', '217814', 1410565),
#                                (392, '00110', '215914', 1410565),
#                                (392, '00110', '217814', 1410565),
#  (391, '01086', '017230', 1410565),
#  (114, '00168', '020046', 410565)])
```


```python
#  location01077.count()
```


```python
# location01077_test=location01077.filter(lambda x:33 in x[0])
result_location01077=location01077.map(lambda x: ((x[1],x[0]),x[2])).groupByKey()
# result_location01077.take(1)
```


```python
# result_location01077.saveAsTextFile("./homework1/ex3/hw1_ex3_listof_user_per_hour_of_allbs ")
```


```python
# resultlist_location01077=result_location01077.map(lambda x : (x[0], list(set(x[1]))))
# # set()去重复
# resultlist_location01077.take(10)
```




    [((u'00901', 708),
      [u'129792',
       u'120387',
       u'120396',
       u'123808',
       u'119802',
       u'077831',
       u'120363',
       u'122113',
       u'122110',
       u'000901',
       u'078743',
       u'095065']),
     ((u'00676', 379),
      [u'066869',
       u'069690',
       u'064689',
       u'075072',
       u'124088',
       u'067966',
       u'127645',
       u'112593',
       u'137191',
       u'089930',
       u'082515',
       u'110806',
       u'082191',
       u'121295',
       u'053036',
       u'080872',
       u'099488',
       u'054542',
       u'135183',
       u'034913',
       u'091077',
       u'126943',
       u'112666',
       u'006663',
       u'119233',
       u'084842',
       u'123996',
       u'062231',
       u'004863',
       u'090618',
       u'059968',
       u'072907',
       u'141659',
       u'123842',
       u'111031',
       u'069373',
       u'003177',
       u'016644',
       u'086432',
       u'114364',
       u'009692',
       u'008056',
       u'142968',
       u'066979',
       u'033807',
       u'116227',
       u'092494',
       u'058866',
       u'020454',
       u'090936',
       u'099506',
       u'017431',
       u'136542',
       u'136018',
       u'122963',
       u'062112',
       u'135917',
       u'035120',
       u'128269',
       u'059853',
       u'101228',
       u'085021',
       u'142386',
       u'137038',
       u'145848',
       u'070870',
       u'053646',
       u'133107',
       u'021191',
       u'104856',
       u'082318',
       u'099343',
       u'023965',
       u'126132',
       u'090306',
       u'083864',
       u'074507',
       u'070995',
       u'116746',
       u'061821',
       u'129296',
       u'077930',
       u'119833',
       u'145794',
       u'109028',
       u'027179',
       u'065303',
       u'042911',
       u'018371',
       u'144011',
       u'074226',
       u'069388',
       u'000008',
       u'052098',
       u'081714',
       u'026158',
       u'090645',
       u'076048',
       u'052984',
       u'083486',
       u'080268',
       u'082277',
       u'065901',
       u'123253',
       u'083169',
       u'068044',
       u'139190',
       u'004635',
       u'124467',
       u'047642',
       u'112543',
       u'125898',
       u'120519',
       u'019419',
       u'023567',
       u'034664',
       u'140977',
       u'082658',
       u'123866',
       u'119824',
       u'134898',
       u'131227',
       u'067052',
       u'116278',
       u'139476',
       u'061475',
       u'133326',
       u'091646',
       u'057448']),
     ((u'00057', 470),
      [u'083935',
       u'124567',
       u'077398',
       u'139787',
       u'127936',
       u'054404',
       u'021403',
       u'000014',
       u'090527',
       u'000010',
       u'127361',
       u'082193',
       u'057518',
       u'067040',
       u'113533',
       u'128093',
       u'083064',
       u'080729',
       u'109342',
       u'118856',
       u'022809',
       u'023544',
       u'075169',
       u'112584',
       u'070734',
       u'091722',
       u'025525',
       u'084402',
       u'136928',
       u'093978',
       u'102327',
       u'049349',
       u'059043',
       u'101426',
       u'114911',
       u'076019',
       u'060188',
       u'121738',
       u'000030',
       u'085383',
       u'070982',
       u'111082',
       u'054342',
       u'071987',
       u'078295',
       u'062661',
       u'011279',
       u'137259',
       u'023924',
       u'088176',
       u'002500',
       u'048213',
       u'124297',
       u'065119',
       u'071779',
       u'081327',
       u'074804',
       u'017452',
       u'007860',
       u'062320',
       u'018230',
       u'066808',
       u'040302',
       u'087537',
       u'087533',
       u'077698',
       u'060249',
       u'085199',
       u'084032',
       u'068033',
       u'068845',
       u'011604',
       u'080573',
       u'139331',
       u'097165',
       u'102783',
       u'086913',
       u'143095',
       u'142254',
       u'085483',
       u'055467',
       u'087981',
       u'054461',
       u'063844',
       u'130536',
       u'126350',
       u'060255',
       u'071881',
       u'132356',
       u'064742',
       u'074931',
       u'073285',
       u'032573',
       u'085043',
       u'074938',
       u'082576',
       u'105274',
       u'090284',
       u'063050',
       u'096899',
       u'140199',
       u'143471',
       u'144409',
       u'087002',
       u'004680',
       u'045901',
       u'070792',
       u'011550',
       u'130204',
       u'012502',
       u'081355',
       u'032859',
       u'084242',
       u'065390',
       u'077430',
       u'116675',
       u'089955',
       u'089954',
       u'022268',
       u'080318',
       u'002097',
       u'023743',
       u'073437',
       u'066525',
       u'115701',
       u'018775',
       u'064397',
       u'120519',
       u'136427',
       u'074984',
       u'004631',
       u'011085',
       u'068384',
       u'097136',
       u'069390',
       u'122798',
       u'000008',
       u'040694',
       u'086474',
       u'055181',
       u'067455']),
     ((u'00818', 104),
      [u'115476',
       u'016821',
       u'113587',
       u'101899',
       u'065468',
       u'120447',
       u'022330',
       u'120445',
       u'120444',
       u'081469',
       u'116204',
       u'090165',
       u'082427',
       u'017596',
       u'069220',
       u'095721',
       u'122541',
       u'141507',
       u'089434',
       u'066502',
       u'081820',
       u'012539',
       u'085363',
       u'090297',
       u'102823',
       u'070644',
       u'102458',
       u'067181',
       u'117955',
       u'045857',
       u'111026',
       u'143408',
       u'060085',
       u'089978',
       u'098972',
       u'128062',
       u'116537',
       u'128138',
       u'113636',
       u'121889',
       u'123830',
       u'117823',
       u'021613',
       u'143338',
       u'144741',
       u'122112',
       u'137742',
       u'083620',
       u'076766',
       u'046012',
       u'079957',
       u'067294',
       u'012661',
       u'102975',
       u'065950',
       u'131254',
       u'075593',
       u'098288',
       u'103572',
       u'052333',
       u'133803',
       u'088952',
       u'062919',
       u'134479',
       u'059195',
       u'009179',
       u'021622',
       u'008478',
       u'128717',
       u'073297',
       u'139491',
       u'009214',
       u'080883']),
     ((u'00160', 301),
      [u'111303',
       u'113828',
       u'063798',
       u'121101',
       u'082512',
       u'002969',
       u'118735',
       u'061372',
       u'059277',
       u'090165',
       u'054678',
       u'000932',
       u'054205',
       u'077463',
       u'062131',
       u'107116',
       u'075960',
       u'090166',
       u'080686',
       u'082508',
       u'053354',
       u'085572',
       u'007787',
       u'130146',
       u'143325',
       u'083950',
       u'117832',
       u'062201',
       u'027816',
       u'084288',
       u'045942',
       u'121735',
       u'104142',
       u'008217',
       u'145352',
       u'134115',
       u'125601',
       u'111026',
       u'071929',
       u'101783',
       u'067269',
       u'068101',
       u'068109',
       u'037469',
       u'052569',
       u'082451',
       u'084869',
       u'131660',
       u'102447',
       u'065957',
       u'069705',
       u'064740',
       u'071779',
       u'063632',
       u'016741',
       u'065619',
       u'136570',
       u'010349',
       u'052759',
       u'010516',
       u'083225',
       u'104084',
       u'033395',
       u'027766',
       u'070605',
       u'051955',
       u'106032',
       u'002921',
       u'141607',
       u'133877',
       u'061706',
       u'123973',
       u'065447',
       u'143360',
       u'115720',
       u'128036',
       u'009384',
       u'061228',
       u'111063',
       u'131242',
       u'129295',
       u'031768',
       u'064720',
       u'114922',
       u'017246',
       u'087855',
       u'086903',
       u'090659',
       u'045994',
       u'115733',
       u'143041',
       u'070813',
       u'080719',
       u'075453',
       u'050684',
       u'117565',
       u'067319',
       u'008627',
       u'074907',
       u'077999',
       u'138477',
       u'071709',
       u'052781',
       u'019789',
       u'055904',
       u'106534',
       u'097879',
       u'086885',
       u'098952',
       u'083926',
       u'088236',
       u'091902',
       u'108330',
       u'064780',
       u'052006',
       u'133731',
       u'098338']),
     ((u'00678', 400),
      [u'006791',
       u'112513',
       u'067966',
       u'083839',
       u'059975',
       u'036779',
       u'127570',
       u'105467',
       u'074618',
       u'071595',
       u'005379',
       u'109503',
       u'090654',
       u'090081',
       u'111897',
       u'019562',
       u'023065',
       u'009334',
       u'028083',
       u'064926',
       u'016526',
       u'071832',
       u'062203',
       u'115107',
       u'016457',
       u'059204',
       u'059203',
       u'140607',
       u'090601',
       u'109974',
       u'111029',
       u'060327',
       u'012555',
       u'061848',
       u'126724',
       u'137543',
       u'145977',
       u'068181',
       u'118332',
       u'133802',
       u'106886',
       u'060340',
       u'055710',
       u'002744',
       u'011986',
       u'087027',
       u'067890',
       u'112315',
       u'025490',
       u'130159',
       u'121094',
       u'065331',
       u'033608',
       u'001615',
       u'133440',
       u'008719',
       u'140508',
       u'009274',
       u'130258',
       u'027178',
       u'118806',
       u'086412',
       u'112650',
       u'073116',
       u'120463',
       u'123708',
       u'002068',
       u'017259',
       u'076048',
       u'080268',
       u'082277',
       u'124034',
       u'089062',
       u'116645',
       u'062098',
       u'060377',
       u'115246',
       u'024117',
       u'116889',
       u'039274',
       u'106844',
       u'008436',
       u'055450',
       u'032609',
       u'132422',
       u'126045',
       u'057448',
       u'003502',
       u'060110',
       u'083806',
       u'131752',
       u'118979',
       u'065841',
       u'013900',
       u'073345',
       u'059569',
       u'067877',
       u'034521',
       u'111543',
       u'096077',
       u'142118',
       u'127562',
       u'103279',
       u'127568',
       u'131878',
       u'120427',
       u'123429',
       u'115664',
       u'077150',
       u'085265',
       u'135021',
       u'058875',
       u'083320',
       u'031354',
       u'144680',
       u'037464',
       u'130157',
       u'115671',
       u'095204',
       u'080740',
       u'116336',
       u'082247',
       u'104984',
       u'082528',
       u'139246',
       u'006441',
       u'023654',
       u'028386',
       u'111016',
       u'020402',
       u'053649',
       u'060240',
       u'128325',
       u'137410',
       u'066335',
       u'118574',
       u'011769',
       u'102437',
       u'081041',
       u'046998',
       u'118320',
       u'017507',
       u'090116',
       u'013942',
       u'126132',
       u'087543',
       u'032105',
       u'083864',
       u'127694',
       u'080851',
       u'125415',
       u'065546',
       u'082385',
       u'093515',
       u'129230',
       u'057810',
       u'000674',
       u'011900',
       u'085042',
       u'110982',
       u'002954',
       u'014012',
       u'116508',
       u'133204',
       u'101706',
       u'002497',
       u'059009',
       u'081469',
       u'091992',
       u'114012',
       u'120777',
       u'068553',
       u'026363',
       u'103245',
       u'112543',
       u'107906',
       u'084663',
       u'034706',
       u'006415',
       u'016716',
       u'002788',
       u'128954',
       u'032687',
       u'096326',
       u'011534',
       u'017301',
       u'115714',
       u'000002',
       u'080278',
       u'061000',
       u'032923',
       u'082369',
       u'000009',
       u'074844',
       u'104565',
       u'099679',
       u'106540',
       u'108107',
       u'010834',
       u'108021',
       u'123230',
       u'103415',
       u'011510',
       u'027924',
       u'060996',
       u'144721',
       u'135120',
       u'135837',
       u'131321',
       u'131048',
       u'000739',
       u'061868',
       u'124479',
       u'000300',
       u'082477',
       u'123046',
       u'140415',
       u'077311',
       u'104838',
       u'049343',
       u'034536',
       u'124501',
       u'079306',
       u'111556',
       u'084499',
       u'009458',
       u'107581',
       u'029420',
       u'049336',
       u'053542',
       u'055555',
       u'007570',
       u'026181',
       u'122962',
       u'016599',
       u'099506',
       u'122440',
       u'000010',
       u'090289',
       u'010277',
       u'062524',
       u'120704',
       u'137134',
       u'071710',
       u'001842',
       u'067003',
       u'123883',
       u'086155',
       u'032249',
       u'139138',
       u'009670',
       u'076341',
       u'112827',
       u'004040',
       u'127073',
       u'013437',
       u'141580',
       u'072294',
       u'001290',
       u'012000',
       u'010610',
       u'118315',
       u'057300',
       u'004035',
       u'080197',
       u'127915',
       u'082640',
       u'000768',
       u'096186',
       u'097705',
       u'128703',
       u'090870',
       u'113831',
       u'108982',
       u'029991',
       u'090879',
       u'120665',
       u'121448',
       u'019611',
       u'090642',
       u'019718',
       u'084665',
       u'127469',
       u'067825',
       u'064473',
       u'059083',
       u'117547',
       u'123725',
       u'112593',
       u'083630',
       u'082595',
       u'072440',
       u'074870',
       u'043428',
       u'119774',
       u'083182',
       u'017331',
       u'129006',
       u'142826',
       u'073007',
       u'035719',
       u'137847',
       u'121884',
       u'085089',
       u'003344',
       u'098666',
       u'031933',
       u'116706',
       u'086296',
       u'141559',
       u'122339',
       u'095384',
       u'111032',
       u'092297',
       u'032010',
       u'017067',
       u'084919',
       u'143972',
       u'132178',
       u'118551',
       u'098060',
       u'001087',
       u'092655',
       u'092713',
       u'090729',
       u'013962',
       u'030585',
       u'067573',
       u'125434',
       u'122199',
       u'030901',
       u'049315',
       u'090269',
       u'069627',
       u'126805',
       u'068582',
       u'114299',
       u'142138',
       u'066366',
       u'082617',
       u'054986',
       u'053774',
       u'131893',
       u'026647',
       u'086245',
       u'092436',
       u'076904',
       u'007744',
       u'104856',
       u'059188',
       u'120498',
       u'071578',
       u'132850',
       u'086912',
       u'110916',
       u'078866',
       u'048455',
       u'084531',
       u'043998',
       u'006903',
       u'142404',
       u'087451',
       u'079074',
       u'003123',
       u'053398',
       u'067031',
       u'098625',
       u'083987',
       u'119787',
       u'033306',
       u'119835',
       u'142913',
       u'107156',
       u'080116',
       u'062342',
       u'082839',
       u'009707',
       u'016946',
       u'065544',
       u'057946',
       u'118454',
       u'069388',
       u'069389',
       u'105113',
       u'090645',
       u'079797',
       u'032758',
       u'118061',
       u'115136',
       u'136674',
       u'090032',
       u'033371',
       u'092363',
       u'071709',
       u'082165',
       u'103794',
       u'010039',
       u'131180',
       u'098080',
       u'000895',
       u'013985',
       u'055589',
       u'072233',
       u'083473',
       u'013161',
       u'084894']),
     ((u'00906', 253),
      [u'105536',
       u'032426',
       u'116508',
       u'074143',
       u'126578',
       u'082296',
       u'011303',
       u'124584',
       u'128321',
       u'124582',
       u'052677',
       u'059125',
       u'014412',
       u'054527',
       u'011152',
       u'075393',
       u'104089',
       u'110680',
       u'090608',
       u'026887',
       u'121759',
       u'092451',
       u'143522',
       u'071765',
       u'002979',
       u'081645',
       u'117828',
       u'113331',
       u'097703',
       u'008349',
       u'085543',
       u'074773',
       u'124226',
       u'132395',
       u'007116',
       u'132957',
       u'067083',
       u'080183',
       u'005762',
       u'132909',
       u'119193',
       u'083804',
       u'081794',
       u'090531',
       u'083866',
       u'127521',
       u'029593',
       u'117439',
       u'070789',
       u'119722',
       u'104909',
       u'144128',
       u'132025',
       u'106554',
       u'090143',
       u'057863',
       u'087657',
       u'108528',
       u'142919',
       u'017328',
       u'081855',
       u'097301',
       u'017547',
       u'118125',
       u'084188',
       u'025930',
       u'097674',
       u'071839',
       u'016693',
       u'016470',
       u'065261',
       u'010658',
       u'054921',
       u'097174',
       u'009642',
       u'104780']),
     ((u'01015', 556),
      [u'123829',
       u'000271',
       u'004286',
       u'068528',
       u'060071',
       u'130258',
       u'052746',
       u'117242',
       u'129353',
       u'073351',
       u'128476',
       u'001673',
       u'062485']),
     ((u'00326', 325),
      [u'023835',
       u'137078',
       u'059263',
       u'080735',
       u'083856',
       u'089968',
       u'087577',
       u'139548',
       u'087439',
       u'011686',
       u'145220',
       u'083916',
       u'137194',
       u'121510',
       u'119821',
       u'140556',
       u'054750',
       u'062964',
       u'078218',
       u'011582',
       u'068096',
       u'075063',
       u'110800',
       u'049973',
       u'127243',
       u'103260',
       u'139507',
       u'095828',
       u'084887',
       u'013911',
       u'071510',
       u'066689',
       u'044257',
       u'077444',
       u'006786',
       u'117705',
       u'115376',
       u'090225',
       u'114956',
       u'029409',
       u'092352',
       u'119726',
       u'001376',
       u'085025',
       u'112481',
       u'116455',
       u'062119',
       u'095326',
       u'130705',
       u'059199',
       u'092190',
       u'009259',
       u'010779',
       u'002760',
       u'000129',
       u'114618',
       u'026484',
       u'062327',
       u'092496',
       u'125934',
       u'129536',
       u'086795',
       u'009214',
       u'104844']),
     ((u'00066', 677),
      [u'108027',
       u'127876',
       u'132324',
       u'142513',
       u'137051',
       u'047067',
       u'080319',
       u'118739',
       u'081847',
       u'110806',
       u'080216',
       u'067014',
       u'070729',
       u'061885',
       u'071941',
       u'132953',
       u'085082',
       u'123321',
       u'106347',
       u'085472',
       u'129922',
       u'124002',
       u'021900',
       u'013870',
       u'072760',
       u'020295',
       u'119891',
       u'090574',
       u'086971',
       u'087965',
       u'102726',
       u'127225',
       u'125434',
       u'021493',
       u'107538',
       u'145767',
       u'143098',
       u'137421',
       u'133962',
       u'064287',
       u'080745',
       u'108500',
       u'055655',
       u'080136',
       u'139328',
       u'085495',
       u'141722',
       u'074243',
       u'080672',
       u'038533',
       u'108803',
       u'111074',
       u'073857',
       u'056338',
       u'114584',
       u'102430',
       u'108789',
       u'133749',
       u'102625',
       u'056278',
       u'017378',
       u'128219',
       u'090591',
       u'142315',
       u'024099',
       u'121783',
       u'034607',
       u'111061',
       u'082385',
       u'105445',
       u'086576',
       u'042343',
       u'124532',
       u'106517',
       u'083556',
       u'115316',
       u'025623',
       u'074437',
       u'115735',
       u'087003',
       u'010233',
       u'004750',
       u'071954',
       u'060266',
       u'051364',
       u'091246',
       u'073535',
       u'119791',
       u'082373',
       u'111295',
       u'108123',
       u'097707',
       u'083999',
       u'082489',
       u'121775',
       u'018483',
       u'074701',
       u'064543',
       u'104109',
       u'124387',
       u'080703',
       u'095518',
       u'082651',
       u'060848',
       u'114064',
       u'066618',
       u'081857',
       u'144489',
       u'128813',
       u'085062',
       u'121766',
       u'017027',
       u'126206',
       u'012906',
       u'104111'])]




```python

# rdd2 = sc.parallelize([("red",40),("red",50),("yellow", 10000)])

# rdd2.cartesian(rdd2).collect()
```


```python
# import itertools
# somelists = [
#    [1, 2, 3],
#    ['a', 'b'],
#    [4, 5]
# ]
# somelists1=['015914','000059','020046','000149']
# testlist=somelists1.sort()
# print(sorted(somelists1)[1])
# def get_list_cartesian(somelists1):
#     for element in itertools.product(*somelists1):#*自乘
#         print element
# get_list_cartesian(somelists1)
```


```python
# def merge(list1): 
#     sortedlist=sorted(list1)
#     merged_list = [(list1[i], list1[i+1]) for i in range(0, len(list1)-1)] 
#     return merged_list
def merge(list1): 
    sortedlist=sorted(list1)
    merged_list = [(sortedlist[i], sortedlist[i+1]) for i in range(0, len(sortedlist)-1)] 
    return merged_list
# merge(somelists1)
```


```python
# result_location01077_test=resultlist_location01077.filter(lambda x:'000011' in x[1])
# result_location01077_test=resultlist_location01077.first()
# result_location01077_test.collect()
```


```python
cartesian_location01077=result_location01077.map(lambda x :(x[0],merge(list(set(x[1])))))
# cartesian_location01077.collect()
```


```python
# join_location01077_result=result_location01077.join(result_location01077)
# join_location01077_result.collect()
```


```python
# join_location01077_list=join_location01077_result.map(lambda x : (list(set(x[1][0])), list(set(x[1]))))
# join_location01077_list.take(1)
```


```python
# n = sc.parallelize(list([1,2,3,4,5,6,7,8,2,4,2,1,1,1,1,1]))
# n.take(2)
# n2 = n.countByValue()
# n2
```


```python
# rdd = sc.parallelize([('key', ['ele1', 'ele2'])])
# rdd.flatMap(lambda data: [(data[0], x) for x in data[1]]).collect()
```


```python
cartesian_location010772=cartesian_location01077.flatMap(lambda data:[(x) for x in data[1]])
cartesian_location010772.take(10)
```




    [(u'000901', u'077831'),
     (u'077831', u'078743'),
     (u'078743', u'095065'),
     (u'095065', u'119802'),
     (u'119802', u'120363'),
     (u'120363', u'120387'),
     (u'120387', u'120396'),
     (u'120396', u'122110'),
     (u'122110', u'122113'),
     (u'122113', u'123808')]




```python
cartesian_location01077_count=cartesian_location010772.countByValue()
# cartesian_location01077_count
```


```python
# def readDict(filename, sep):
#     with open(filename, "r") as f:
#         dict = {}
#         for line in f:
#             values = line.split(sep)
#             dict[values[0]] = {int(x) for x in values[1:len(values)]}
#         return(dict)

pd_cartesian_location01077_count=pd.DataFrame(cartesian_location01077_count,
                                              #columns=[i[0] for i in cartesian_location01077_count.keys()],
                                              index=[0] #[i for i in cartesian_location01077_count.keys()]
                                             ).T
pd_cartesian_location01077_count
# def writeDict(dict, filename, sep):
# #     with open(filename, "a") as f:
# for i in cartesian_location01077_count.keys():  
#     print(i,cartesian_location01077_count[i],i[0])
            #f.write(i + " " + sep.join(dict[i]) + "\n")
# writeDict(cartesian_location01077_count,"/home/huangjingying/homework1/test.txt","\t")     
```


```python
# # header = rdd.first()
# # rdd.filter(lambda line: line != header)
# header = pd_cartesian_location01077_count.first()
# pd_cartesian_location01077_count2=pd_cartesian_location01077_count.filter(lambda line: line != header)
```


```python
pd_cartesian_location01077_count.to_csv("/home/huangjingying/homework1/ex3/hw1_ex3_countsof_edges_per_hour_allBSs_.txt",sep="\t")
```
